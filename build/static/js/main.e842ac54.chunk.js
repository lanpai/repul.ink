(this["webpackJsonprepul.ink"]=this["webpackJsonprepul.ink"]||[]).push([[0],{120:function(e,t,c){"use strict";c.r(t);var a=c(1),s=c.n(a),n=c(64),r=c.n(n),i=(c(71),c(13)),o=c(4),l=c(6),j=c(65),b=c(0);var d=function(e){var t=e.text,c=e.color,a=e.type;return Object(b.jsx)("a",{href:"/",children:Object(b.jsxs)("div",{className:"social",style:{backgroundColor:c},children:[Object(b.jsx)("span",{children:t}),Object(b.jsx)("i",{className:"fab fa-".concat(a)})]})})};var u=function(){var e="me"==Object(o.f)().username,t=Object(a.useState)(Object(o.f)().username),c=Object(l.a)(t,2),s=c[0],n=c[1],r=Object(a.useState)(),u=Object(l.a)(r,2),h=u[0],O=u[1],p=Object(a.useState)(),x=Object(l.a)(p,2),f=x[0],y=x[1],g=Object(a.useState)(),v=Object(l.a)(g,2),m=(v[0],v[1]),w=Object(a.useState)(),k=Object(l.a)(w,2);return k[0],k[1],Object(a.useEffect)((function(){fetch("/api/id/".concat(s)).then((function(e){return e.json()})).then((function(e){e.code&&(window.location.href="/"),n(e.username),O(e.name),y(e.blurb),m(e.key_decrypt)}),(function(e){window.location.href="/"}))}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{style:{opacity:h?1:0},className:"box",children:[Object(b.jsx)("div",{className:"qr",children:Object(b.jsx)(j.QRCode,{value:"".concat(window.location.origin,"/id/").concat(s),qrStyle:"dots",bgColor:"#1c1f28",fgColor:"#f8faf9",logoImage:"/logo.png",logoWidth:"40",logoOpacity:"0.8"})}),Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:h}),Object(b.jsx)("p",{children:f}),Object(b.jsx)("div",{children:Object(b.jsxs)("div",{style:{display:"inline-block"},children:[Object(b.jsx)(d,{text:"Jihoon Yang (@lanpai)",color:"#1DA1F2",type:"twitter"}),Object(b.jsx)(d,{text:"Jihoon Yang (@lanpai)",color:"#0366d6",type:"github"}),Object(b.jsx)(d,{text:"Jihoon Yang",color:"#4267B2",type:"facebook"})]})}),e&&Object(b.jsx)(i.b,{to:"/edit",children:Object(b.jsx)("small",{className:"soft",children:"Edit your profile"})})]})]}),Object(b.jsx)("div",{style:{display:e?"flex":"none",opacity:h?1:0},className:"box",children:Object(b.jsx)("div",{className:"qr"})})]})},h=c(7),O=c.n(h),p=c(18),x=c.n(p);function f(e,t){var c=O.a.random.getBytesSync(8),a=O.a.pbe.opensslDeriveBytes(e,c,32),s=O.a.util.createBuffer(a),n=s.getBytes(24),r=s.getBytes(8),i=O.a.cipher.createCipher("3DES-CBC",n);i.start({iv:r}),i.update(O.a.util.createBuffer(t)),i.finish();var o=O.a.util.createBuffer();return null!==c&&(o.putBytes("Salted__"),o.putBytes(c)),o.putBuffer(i.output),o.getBytes()}function y(){return Object(b.jsx)("i",{style:{textAlign:"center",width:16},className:"fas fa-check"})}function g(){return Object(b.jsx)("i",{style:{textAlign:"center",width:16},className:"fas fa-times"})}var v=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),c=t[0],s=t[1],n=Object(a.useState)(""),r=Object(l.a)(n,2),o=r[0],j=r[1],d=o.length>=14,u=/(?=.*[a-z])(?=.*[A-Z])/.test(o),h=/(?=.*[-+_!@#$%^&*., ?])/.test(o);return Object(b.jsx)("div",{className:"box",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Create your repul.ink account"}),Object(b.jsxs)("div",{style:{padding:5},children:[Object(b.jsxs)("p",{children:[d?Object(b.jsx)(y,{}):Object(b.jsx)(g,{})," Must contain at least 14 characters"]}),Object(b.jsxs)("p",{children:[u?Object(b.jsx)(y,{}):Object(b.jsx)(g,{})," Must have both capital and lowercase letters"]}),Object(b.jsxs)("p",{children:[h?Object(b.jsx)(y,{}):Object(b.jsx)(g,{})," Must contain at least 1 symbol"]}),Object(b.jsx)("input",{type:"text",placeholder:"Username",value:c,onChange:function(e){s(e.target.value)}}),Object(b.jsx)("input",{type:"password",placeholder:"Password",value:o,onChange:function(e){j(e.target.value)}}),Object(b.jsx)("button",{onClick:function(e){return c?d?u?h?void O.a.pki.rsa.generateKeyPair({bits:2048,workers:2},(function(e,t){e&&console.error(e);var a=O.a.pki.publicKeyToPem(t.publicKey),s=O.a.pki.privateKeyToPem(t.privateKey);console.log(a),console.log(s),x.a.post("/api/register",{username:c,key_decrypt:a,key_encrypt:f(o,s)}).then((function(e){switch(e.data.code){case 0:window.location.href="/login";break;default:alert(e.data.message)}}))})):alert("Must contain at least 1 symbol"):alert("Must have both capital and lowercase letters"):alert("Must contain at least 14 characters!"):alert("Username is required!")},children:"Register"}),Object(b.jsx)(i.b,{to:"/login",children:Object(b.jsx)("small",{className:"soft",children:"Already have an account?"})})]})]})})};function m(){return Object(b.jsx)("i",{style:{textAlign:"center",width:16},className:"fas fa-check"})}function w(){return Object(b.jsx)("i",{style:{textAlign:"center",width:16},className:"fas fa-times"})}var k=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),c=t[0],s=t[1],n=Object(a.useState)(""),r=Object(l.a)(n,2),o=r[0],j=r[1],d=o.length>=14,u=/(?=.*[a-z])(?=.*[A-Z])/.test(o),h=/(?=.*[-+_!@#$%^&*., ?])/.test(o);return Object(b.jsx)("div",{className:"box",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Login to your repul.ink account"}),Object(b.jsxs)("div",{style:{padding:5},children:[Object(b.jsxs)("p",{children:[d?Object(b.jsx)(m,{}):Object(b.jsx)(w,{})," Password contains at least 14 characters"]}),Object(b.jsxs)("p",{children:[u?Object(b.jsx)(m,{}):Object(b.jsx)(w,{})," Password contains both capital and lowercase letters"]}),Object(b.jsxs)("p",{children:[h?Object(b.jsx)(m,{}):Object(b.jsx)(w,{})," Password contains at least 1 symbol"]}),Object(b.jsx)("input",{type:"text",placeholder:"Username",value:c,onChange:function(e){s(e.target.value)}}),Object(b.jsx)("input",{type:"password",placeholder:"Password",value:o,onChange:function(e){j(e.target.value)}}),Object(b.jsx)("button",{onClick:function(e){return c?d?u?h?void x.a.post("/api/prepareLogin",{username:c}).then((function(e){switch(e.data.code){case 0:try{var t=O.a.pki.privateKeyFromPem(function(e,t){var c=O.a.util.createBuffer(t);c.getBytes("Salted__".length);var a=c.getBytes(8),s=O.a.pbe.opensslDeriveBytes(e,a,32),n=O.a.util.createBuffer(s),r=n.getBytes(24),i=n.getBytes(8),o=O.a.cipher.createDecipher("3DES-CBC",r);return o.start({iv:i}),o.update(c),o.finish(),o.output.toString()}(o,e.data.key_encryption)),a=O.a.md.sha1.create();a.update(c,"utf8");var s=t.sign(a);x.a.post("/api/login",{username:c,signature:s}).then((function(e){window.location.href="/id/me"})).catch((function(e){alert("Unknown error!")}))}catch(n){alert("Invalid password!")}break;default:alert(e.data.message)}})):alert("Password contains at least 1 symbol"):alert("Password contains both capital and lowercase letters"):alert("Password contains at least 14 characters!"):alert("Username is missing!")},children:"Login"}),Object(b.jsx)(i.b,{to:"/register",children:Object(b.jsx)("small",{className:"soft",children:"Don't have an account?"})})]})]})})};var S=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),c=t[0],s=t[1],n=Object(a.useState)(),r=Object(l.a)(n,2),o=(r[0],r[1]),j=Object(a.useState)(),u=Object(l.a)(j,2),h=u[0],O=u[1],p=Object(a.useState)(),f=Object(l.a)(p,2),y=f[0],g=f[1],v=Object(a.useState)(),m=Object(l.a)(v,2),w=(m[0],m[1]);return Object(a.useEffect)((function(){fetch("/api/id/me").then((function(e){return e.json()})).then((function(e){e.code&&(window.location.href="/"),s(!0),o(e.username),O(e.name),g(e.blurb),w(e.key_decrypt)}),(function(e){window.location.href="/"}))}),[]),Object(b.jsx)("div",{style:{opacity:c?1:0},className:"box",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("input",{style:{color:"var(--highlight)",fontWeight:700,fontSize:32,marginTop:0},type:"text",placeholder:"Display Name",value:h,onChange:function(e){O(e.target.value)}}),Object(b.jsx)("input",{style:{color:"var(--foreground)",fontSize:16,marginTop:0},type:"text",placeholder:"Blurb",value:y,onChange:function(e){g(e.target.value)}}),Object(b.jsx)("div",{children:Object(b.jsxs)("div",{style:{display:"inline-block"},children:[Object(b.jsx)(d,{text:"Connect Twitter",color:"#1DA1F2",type:"twitter"}),Object(b.jsx)(d,{text:"Connect GitHub",color:"#0366d6",type:"github"}),Object(b.jsx)(d,{text:"Connect Facebook",color:"#4267B2",type:"facebook"})]})}),Object(b.jsx)("button",{onClick:function(){x.a.post("/api/edit",{name:h,blurb:y}).then((function(e){switch(e.data.code){case 0:alert("Successfully updated profile.");break;default:alert(e.data.message)}}))},children:"Apply"}),Object(b.jsx)(i.b,{to:"/id/me",children:Object(b.jsx)("small",{className:"soft",children:"View your profile"})})]})})};var B=function(){return Object(b.jsxs)(i.a,{children:[Object(b.jsx)("div",{className:"header",children:Object(b.jsx)(i.b,{to:"/",children:Object(b.jsxs)("h1",{children:[Object(b.jsx)("img",{src:"/logo192.png"}),"repul.ink"]})})}),Object(b.jsx)("div",{className:"center",children:Object(b.jsxs)(o.c,{children:[Object(b.jsx)(o.a,{path:"/register",children:Object(b.jsx)(v,{})}),Object(b.jsx)(o.a,{path:"/login",children:Object(b.jsx)(k,{})}),Object(b.jsx)(o.a,{path:"/id/:username",children:Object(b.jsx)(u,{})}),Object(b.jsx)(o.a,{path:"/edit",children:Object(b.jsx)(S,{})}),Object(b.jsx)(o.a,{path:"/",exact:!0,children:Object(b.jsx)("h1",{children:"Under Construction"})}),Object(b.jsx)(o.a,{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Page not found"}),Object(b.jsx)("p",{children:"Seems you've taken a wrong turn!"})]})})]})})]})};r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(B,{})}),document.getElementById("root"))},35:function(e,t){},71:function(e,t,c){}},[[120,1,2]]]);
//# sourceMappingURL=main.e842ac54.chunk.js.map